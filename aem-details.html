<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced Emission Model (AEM) â€“ Tools Style</title>
<link href="https://fonts.googleapis.com/css2?family=Exo:ital,wght@0,100..900;1,100..900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
<style>
    :root {
      --primary: #009F6E; --primary-dark: #075E54; --accent: #009F6E;
      --ink: #212121; --paper: #FCFCFC;
      --bg-gradient-start: #FCFCFC; --bg-gradient-end: #EAF4FF;
      --surface: #FFFFFF; --surface-elev: rgba(255,255,255,0.8);
      --border: rgba(0,0,0,0.08);
      --text-primary: #212121; --text-secondary: #455A64; --text-inverse: #FFFFFF;
      --focus: #009F6E; --shadow: 0 10px 30px rgba(0,0,0,0.08);
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Exo';
      text-align:justify;
      background: linear-gradient(135deg, var(--bg-gradient-start), var(--bg-gradient-end));
      color: var(--text-primary);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
    }
    /* Decorative soft background spot using brand green */
    body::before {
      content: '';
      position: fixed;
      top: -20%; left: -10%;
      width: 700px; height: 700px;
      background: radial-gradient(circle, rgba(0,159,110,0.12) 0%, transparent 65%);
      filter: blur(60px);
      z-index: -1;
      pointer-events: none;
    }
    .topbar {
      position: sticky; top: 0; z-index: 1000;
      background: rgba(252,252,252,0.8);
      backdrop-filter: saturate(140%) blur(10px);
      border-bottom: 1px solid var(--border);
    }
    .topbar-inner { max-width: 1200px; margin: 0 auto; display: flex; align-items: center; gap: 12px; padding: 12px 16px; }
    .brand { color: var(--ink); text-decoration: none; font-weight: 800; letter-spacing: .2px; }
    .brand:hover { color: var(--primary-dark); }
    .menu-toggle { margin-left: auto; font-size: 1.6rem; line-height: 1; background: transparent; color: var(--ink); border: 0; cursor: pointer; padding: 4px 8px; }
    .menu-toggle:focus { outline: 2px solid var(--focus); outline-offset: 2px; border-radius: 6px; }
    nav.primary .menu { list-style: none; display: none; flex-direction: column; gap: 0; width: 100%; background: transparent; margin-top: 8px; }
    nav.primary .menu.open { display: flex }
    nav.primary .menu a { display: block; color: var(--ink); text-decoration: none; padding: 10px 12px; border-radius: 8px; }
    nav.primary .menu a:hover, nav.primary .menu a:focus { background: rgba(41,144,234,0.12); outline: none; }
    nav.primary .menu li.active>a, nav.primary .menu a[aria-current="page"] { background: rgba(0,159,110,0.12); font-weight: 600 }
    @media (min-width: 768px){
      .menu-toggle { display: none }
      .topbar-inner { display: grid; grid-template-columns: auto 1fr; align-items: center }
      nav.primary { justify-self: end }
      nav.primary .menu { display: flex !important; flex-direction: row; align-items: center; gap: 8px; background: transparent; margin-top: 0 }
      nav.primary .menu a { padding: 8px 10px }
    }
    header { text-align: center; padding: 64px 24px 24px; }
    h1 { font-size: clamp(2rem, 6vw, 3.25rem); font-weight: 800; letter-spacing: -0.02em; margin-bottom: 12px; color: var(--primary-dark); }
    p.subtitle { font-size: clamp(1rem, 3.2vw, 1.15rem); color: var(--text-secondary); max-width: 900px; margin: 0 auto; line-height: 1.65; }
    main { flex: 1; max-width: 1200px; margin: 0 auto; padding: 24px; display: grid; grid-template-columns: 1fr; gap: 28px; width: 100%; }
    section { background: var(--surface-elev); border: 1px solid var(--border); border-radius: 16px; padding: clamp(18px, 3.5vw, 28px); box-shadow: var(--shadow); }
    section h2 { font-size: 1.4rem; margin-bottom: 10px; color: var(--ink); }
    section h3 { font-size: 1rem; margin-bottom: 10px; color: var(--ink); }
    section p, section li { margin-bottom: 10px;color: var(--text-secondary); line-height: 1.65; }
    section li {margin-left: 30px;}
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 18px; }
    .card { background: var(--surface-elev); border: 1px solid var(--border); border-radius: 16px; padding: clamp(18px, 3.5vw, 28px); box-shadow: var(--shadow); transition: transform .25s ease, box-shadow .25s ease; display: flex; flex-direction: column; }
    .card:hover { transform: translateY(-4px); box-shadow: 0 16px 36px rgba(0,0,0,0.12); }
    .card-icon { font-size: 28px; color: var(--accent); margin-bottom: 14px; background: rgba(0,159,110,0.10); width: 52px; height: 52px; display: flex; align-items: center; justify-content: center; border-radius: 12px; }
    .card h2 { font-size: 1.25rem; margin-bottom: 10px; font-weight: 700; color: var(--ink); }
    .card p { color: var(--text-secondary); font-size: 0.98rem; line-height: 1.6; margin-bottom: 16px; }
    .btn { display: inline-flex; align-items: center; justify-content: center; gap: 8px; text-decoration: none; color: var(--text-inverse); background: var(--primary); padding: 12px 18px; border-radius: 999px; font-weight: 700; transition: background .2s ease, transform .05s ease; width: fit-content; }
    .btn:hover { background: var(--primary-dark); }
    .btn:active { transform: scale(0.98); }

    /* NEW: toggle button style to match .btn but as a <button> */
    .btn-ghost {
      display: inline-flex; align-items: center; gap: 8px;
      background: var(--primary); color: var(--text-inverse);
      border: none; border-radius: 999px;
      padding: 10px 14px; font-weight: 700; cursor: pointer;
      width: fit-content;
    }
    .btn-ghost:hover { background: var(--primary-dark); }

    /* NEW: expandable placeholder list styling */
    .placeholder-list {
      margin-top: 12px;
      padding-left: 18px;
      display: none;               /* hidden by default */
      animation: fadeIn .18s ease;
    }
    .placeholder-list.show { display: block; }
    .placeholder-list p { margin: 6px 0; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-2px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    footer { text-align: center; padding: 36px 20px; color: #607D8B; font-size: 0.9rem; }
    /* Accessibility helpers */
    .skip-link { position: absolute; left: -999px; top: 0; background: var(--paper); color: var(--ink); padding: 8px 12px; border-radius: 4px; }
    .skip-link:focus { left: 8px; outline: 2px solid var(--focus); }
    @media (max-width: 600px){
      header { padding: 40px 20px 16px; }
      main { grid-template-columns: 1fr; padding: 16px; }
      .card { border-radius: 14px; }
    }
    .cta-buttons { display: flex; gap: 12px; justify-content: center; margin-top: 30px; }
.cta-buttons a { background: var(--primary); color: #0a2e23; text-decoration: none; padding: 12px 20px; border-radius: 8px; font-weight: 600; transition: background 0.3s ease; }
.cta-buttons a:hover { background: var(--primary-dark); }

.badge.level-badge{
  gap: 4px;                /* smaller space between icon + text */
  padding: 3px 6px;        /* reduce size */
  font-size: 11px;         /* smaller text */
  border-radius: 999px;
  border: 1px solid var(--border);
  background: rgba(41,144,234,.10);
  color: var(--ink);
  font-weight: 600;        /* slightly lighter for readability */
  white-space: nowrap;

}
.badge.level-badge.early{background:rgba(255,193,7,.15);border-color:rgba(255,193,7,.35)}
.badge.level-badge.developing{background:rgba(41,144,234,.12);border-color:rgba(41,144,234,.35)}
.badge.level-badge.advanced{background:rgba(0,159,110,.18);border-color:rgba(0,159,110,.35)}

/* Use Cases Slider (CSS Scroll Snap) */
.uc-controls { display: grid; grid-template-columns: 40px 1fr 40px; align-items: center; gap: 8px; margin: 6px 0 12px; }
.uc-prev, .uc-next { appearance: none; border: 1px solid var(--border); background: var(--surface-elev); color: var(--ink); width: 40px; height: 40px; border-radius: 999px; font-size: 20px; line-height: 1; cursor: pointer; box-shadow: var(--shadow); }
.uc-prev:hover, .uc-next:hover { background: rgba(41,144,234,.10); }
.uc-dots { display: flex; justify-content: center; gap: 6px; }
.uc-dots button { width: 10px; height: 10px; border-radius: 50%; border: 1px solid var(--border); background: rgba(0,0,0,0.06); cursor: pointer; }
.uc-dots button[aria-selected="true"] { background: var(--primary); border-color: var(--primary); }
.uc-track { display: grid; grid-auto-flow: column; grid-auto-columns: min(100%, 420px); gap: 18px; overflow-x: auto; scroll-snap-type: x mandatory; scroll-behavior: smooth; padding-bottom: 6px; }
.uc-track:focus { outline: 2px solid var(--focus); outline-offset: 4px; }
.uc-slide { scroll-snap-align: start; }
@media (min-width: 740px) { .uc-track { grid-auto-columns: min(50%, 420px); } }
@media (min-width: 1024px) { .uc-track { grid-auto-columns: min(33%, 420px); } }




  
/* Slider single-case fallback */
.uc-static{grid-auto-flow:row;grid-auto-columns:100%;overflow:visible;scroll-snap-type:none;}

/* Use Cases: one slide per view */
.uc-track{grid-auto-columns:100% !important}

/* Hero style: background image on the card with readable overlay */
.uc-slide.uc-hero{position:relative;min-height:420px;display:flex;flex-direction:column;justify-content:flex-end;background-size:cover;background-position:center;border:1px solid var(--border);border-radius:16px;overflow:hidden;box-shadow:var(--shadow)}
.uc-slide.uc-hero::before{content:"";position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,.25) 0%, rgba(0,0,0,.55) 70%)}
.uc-slide.uc-hero > *{position:relative;z-index:1}
.uc-slide.uc-hero h2{color:#fff;margin:0 0 8px 0;font-weight:800;text-shadow:0 2px 8px rgba(0,0,0,.45)}
.uc-slide.uc-hero p{color:#f0f7f5;margin:0 0 14px 0;line-height:1.6;text-shadow:0 2px 8px rgba(0,0,0,.35)}

@media (max-width:600px){ .uc-slide.uc-hero{min-height:320px} }


.header-actions {
  display: flex;
  justify-content: space-between; /* left item at far left, right item at far right */
  align-items: center;
  gap: 12px;                       /* optional spacing */
}

/* Prevent 'Go to the platform' button from stretching */
.header-actions{flex-wrap:wrap;gap:12px}
.header-cta{flex:0 0 auto;align-self:flex-start}


/* Scope chips (below the CTA + Developing ANSPs) */
.meta-badges{display:flex;flex-direction:column;gap:8px;margin-top:6px}
.meta-badges .meta-label{font-size:12px;font-weight:800;color:var(--text-secondary);text-transform:uppercase;letter-spacing:.04em}
.meta-badges .chips{display:flex;flex-wrap:wrap;gap:10px}
.badge-chip{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;border:1px solid var(--border);background:linear-gradient(180deg, rgba(255,255,255,.9) 0%, rgba(245,249,255,.8) 100%);color:var(--ink);font-size:12px;font-weight:700;box-shadow:0 2px 10px rgba(0,0,0,.06)}
.badge-chip .chip-icon{width:20px;height:20px;display:inline-grid;place-items:center;background:rgba(0,159,110,.12);color:var(--primary-dark);border-radius:50%;font-size:12px}

</style>
  
</head>
<body>
<a class="skip-link" href="#main-content">Skip to content</a>
<div class="topbar" role="banner">
<div class="topbar-inner">
<a aria-label="Homepage" class="brand" href="index.html">AVENIR Catalogue</a>
<button aria-controls="menu-list" aria-expanded="false" aria-label="Open menu" class="menu-toggle" id="menu-toggle">â˜°</button>
<nav aria-label="Primary navigation" class="primary">
<ul class="menu" id="menu-list">
<li><a href="index.html">Introduction</a></li>
<li class="active"><a aria-current="page" href="tools.html">Tools</a></li>
<li><a href="dashboard.html">Dashboards</a></li>
<li><a href="use-cases.html">Use Cases</a></li>
<li><a href="questionnaires.html">Questionnaires</a></li>
<li><a href="#questions">Downloads</a></li>
</ul>
</nav>
</div>
</div>
<header>
<h1 id="main-content">Advanced Emission Model (AEM)</h1>
<p class="subtitle">Detailed information about AEM, its methodology, requirements, limitations, and future developments.</p>
</header>

<main>
<div class="header-actions">
<a class="btn header-cta" href="#" target="_blank" rel="noopener" margin-left="left">Go to the platform</a>
<span class="badge level-badge developing badge-usage">Developing ANSPs</span>
</div>

<div class="meta-badges" role="group" aria-label="AEM scope badges">
  <div class="meta-label">Scope</div>
  <div class="chips">
    <span class="badge-chip" data-focus="COâ‚‚,LAQ,Nonâ€‘COâ‚‚" title="Focus areas: COâ‚‚, LAQ and Nonâ€‘COâ‚‚ effects" aria-label="Focus: COâ‚‚, LAQ, Nonâ€‘COâ‚‚">
      <span class="chip-icon" aria-hidden="true">ðŸŽ¯</span>
      <span class="chip-text">Focus: COâ‚‚, LAQ, Nonâ€‘COâ‚‚</span>
    </span>
    <span class="badge-chip" data-phase="Taxiâ€‘out,Departure/Climb,Descent/Arrival,Taxiâ€‘in" title="Covered phases: Taxiâ€‘out, Departure/Climb, Descent/Arrival, Taxiâ€‘in" aria-label="Phases: Taxiâ€‘out, Departure/Climb, Descent/Arrival, Taxiâ€‘in">
      <span class="chip-icon" aria-hidden="true">ðŸ›«</span>
      <span class="chip-text">Phases: Taxiâ€‘out, Departure/Climb, Descent/Arrival, Taxiâ€‘in</span>
    </span>
    <span class="badge-chip" data-metric="Fuel burn/COâ‚‚,metric-Nonâ€‘COâ‚‚,metric-LAQ" title="Reported metrics: Fuel burn/COâ‚‚, Nonâ€‘COâ‚‚, LAQ" aria-label="Metrics: Fuel burn/COâ‚‚, Nonâ€‘COâ‚‚, LAQ">
      <span class="chip-icon" aria-hidden="true">ðŸ“Š</span>
      <span class="chip-text">Metrics: Fuel burn/COâ‚‚, Nonâ€‘COâ‚‚, LAQ</span>
    </span>
  </div>
</div>

<section>
<h2>Overview</h2>
<p>The Advanced Emission Model2 (AEM) is a software suite which is used for calculation of aircraft engine emissions using 4-dimension trajectories that are cut in segments. It provides the option to calculate 24 pollutants, e.g., CO2, NOx, PMs, HC, Cl, SOx. </p>
<p>One of the different available run modes of AEM allows calculation based on the ICAO CAEP trends method: </p>
<ul>
<li><strong>Below 3,000 ft:</strong> the fuel burn calculation is based on the LTO cycle defined by the ICAO Engine Certification specifications. The ICAO LTO cycle covers four modes of engine operation: approach, taxi, take-off and climb. They are used in AEM to model the following six phases of operations: taxi-out, taxi-in (idle), take-off, climb-out, approach and landing (approach).  </li>
<li><strong>Above 3,000 ft:</strong> during the Climb, Cruise, Descent phases of flight, the fuel burn calculation is based on EUROCONTROLâ€™s BADA model, by using pre-calculated aircraft performance tables. It derives aircraft engine emissions from the calculations. </li>
</ul>
<p>AEM options and setups allow users to adapt the model to their own context and available information: use of input fuel flow (ex. flight data recording, cockpit and real time simulators), atmospheric conditions at the flown segment, adaptation to the study context and reference database evolutions (aircraft and engine definition, default atmospheric model, taxi times, etc.) 

The BFFM2 model is used for calculation of non-linear pollutants such as NOx, CO, HC (&VOC TOG) and vPM. The nvPM MEEM is applied for the calculation of nvPM. AEM provides engine emissions indices for jet and piston engines. Particles emission indices are determined with the FOA4 method.  
AEM supports service providers in their environmental efforts as follows: 
</p>


<ul>
<li><strong>Emission Estimation:</strong> AEM estimates aircraft emissions and fuel burn for various flight profiles and scenarios. It calculates the mass of fuel burned and the corresponding emissions of pollutants such as CO2, NOx, SOx and particulate matter. </li>
<li> <strong>Detailed Analysis:</strong>The tool analyses flight profile data on a flight-by-flight basis, allowing for detailed assessments of emissions for specific air traffic scenarios, from local airport studies to global emissions. </li>
<li><strong>Regulatory Compliance:</strong> AEM helps providers comply with international environmental standards and regulations by providing accurate emissions data that can be used for reporting and regulatory purposes. </li>
<li><strong>Scenario Modelling:</strong> The tool can model different operational scenarios to assess their environmental impact, helping service providers plan and implement more sustainable air traffic management practices. </li>
</ul>
</section>
<section>
<h2>AEM Provider</h2>
<p>AEM is part of EUROCONTROLâ€™s environmental tool suite, composed of:</p>
<ul>
<li>Advanced Emission Model (AEM)</li>
<li>Open-ALAQS</li>
<li>IMPACT</li>
</ul>
</section>
<section>
<h2>Versions and OS Requirements</h2>
<p>Current version: <strong>AEM 2.6.2b</strong> (available since March 2025).</p>
<ul>
<li>AEM_CLI: Command-line executable</li>
<li>AEM_GUI: GUI executable</li>
<li>AEM_GEO: Trajectory pre-processing</li>
<li>AEM database files</li>
<li>AEM API (DLL/.so)</li>
</ul>
<h3>Supported Platforms</h3>
<ul>
<li><strong>Windows:</strong> CLI, GUI, GEO, DB files, API (.dll)</li>
<li><strong>Linux (Red Hat 7 &amp; 8):</strong> CLI, DB files, API (.so)</li>
</ul>
</section>
<section>
<h2>Data Requirements</h2>
<h3>Mandatory</h3>
<ul>
<li>Aircraft type</li>
<li>Phase of flight</li>
<li>Weight category</li>
<li>Timestamp for each segment</li>
<li>Number of movements</li>
<li>Cruise altitude</li>
<li>ADEP and ADES</li>
</ul>
<h3>Optional</h3>
<ul>
<li>True Air Speed or Mach</li>
<li>Atmospheric conditions</li>
<li>Measured fuel flow</li>
</ul>
</section>
<section>
<h2>Limitations</h2>
<ul>
<li>BADA fuel burn uses simplified performance model</li>
<li>Input speed and thrust not used; weight decrease not modeled</li>
<li>Default reference database values require adaptation</li>
<li>Turboprops database not included by default</li>
</ul>
</section>
<section>
<h2>Future Developments</h2>
<ul>
<li>Add single LTO segment types</li>
<li>Update nvPM method (ICAO CAEP/13)</li>
<li>Helicopter fuel and emissions modeling</li>
</ul>
</section>

<section id="related-use-cases" aria-label="Related Use Cases">
  <h2>Related Use Cases</h2>
  <div class="uc-controls">
  <button class="uc-prev" aria-label="Previous use case" title="Previous">â€¹</button>
  <div class="uc-dots" role="tablist" aria-label="Use case slides"></div>
  <button class="uc-next" aria-label="Next use case" title="Next">â€º</button>
</div>
  <div class="uc-track" id="uc-track" tabindex="0" role="region" aria-roledescription="carousel" aria-label="Use cases">
<article class="card uc-slide" role="group" aria-roledescription="slide" aria-label="1 of 3">
      <h2>MUAC - Pre-flight efficiency optimisation  </h2>
      <img src="figure/muac.png" alt="MUAC ATM Portal">
      <p>The Pre-Flight Check (PFC) initiative, launched by the Maastricht Upper Area Control Centre (MUAC) in 2020, aims to enhance flight efficiency during the pre-flight phase. The PFCâ€™s goal is to optimise flight plan routes before departure, by filing a flight plan trajectory closer to the expected actual flight path, improving operational efficiency and environmental sustainability. </p>
    </article>
<article class="card uc-slide" role="group" aria-roledescription="slide" aria-label="2 of 3">
      <h2>MUAC - Pre-flight efficiency optimisation  </h2>
      <img src="figure/muac.png" alt="MUAC ATM Portal">
      <p>The Pre-Flight Check (PFC) initiative, launched by the Maastricht Upper Area Control Centre (MUAC) in 2020, aims to enhance flight efficiency during the pre-flight phase. The PFCâ€™s goal is to optimise flight plan routes before departure, by filing a flight plan trajectory closer to the expected actual flight path, improving operational efficiency and environmental sustainability. </p>
    </article>
<article class="card uc-slide" role="group" aria-roledescription="slide" aria-label="2 of 3">
      <h2>MUAC - Pre-flight efficiency optimisation  </h2>
      <img src="figure/muac.png" alt="MUAC ATM Portal">
      <p>The Pre-Flight Check (PFC) initiative, launched by the Maastricht Upper Area Control Centre (MUAC) in 2020, aims to enhance flight efficiency during the pre-flight phase. The PFCâ€™s goal is to optimise flight plan routes before departure, by filing a flight plan trajectory closer to the expected actual flight path, improving operational efficiency and environmental sustainability. </p>
    </article>
  </div>
</section>

  </div>


</main>
<footer>
<p> <strong>Openâ€‘Source Governance: </strong>The Avenir Catalogue is developed as an openâ€‘source, collaborative reference. Its evolution is driven by operational experience, user feedback, and contributions from ANSPs, ensuring that methods, tools and practices remain aligned with real-world challenges and emerging needs.</p>
<p style="margin-bottom: 1rem;"></p>
<p>Â© 2025 Eurocontrol Sustainability Unit. All rights reserved.</p>
</footer>






<script>

// Menu toggle
    const toggle = document.getElementById('menu-toggle');
    const list = document.getElementById('menu-list');
    toggle?.addEventListener('click', () => {
      const open = list.classList.toggle('open');
      toggle.setAttribute('aria-expanded', String(open));
      toggle.setAttribute('aria-label', open ? 'Close menu' : 'Open menu');
    });

(function(){
  const track = document.getElementById('uc-track');
  if (!track) return;

  const slides = Array.from(track.querySelectorAll('.uc-slide'));
  const prev = document.querySelector('.uc-prev');
  const next = document.querySelector('.uc-next');
  const dotsWrap = document.querySelector('.uc-dots');

  // Turn <img> into background image for each slide and apply hero class
  slides.forEach(slide => {
    const img = slide.querySelector('img');
    if (img && img.getAttribute('src')){
      slide.style.backgroundImage = `url('${img.getAttribute('src')}')`;
      img.remove();
    }
    slide.classList.add('uc-hero');
  });

  // Single-slide fallback
  if (slides.length <= 1) {
    const controls = document.querySelector('.uc-controls');
    if (controls) controls.remove();
    track.classList.add('uc-static');
    track.removeAttribute('aria-roledescription');
    track.setAttribute('aria-label','Use case');
    return;
  }

  // Build dots (per slide)
  const dots = slides.map((_, i) => {
    const b = document.createElement('button');
    b.setAttribute('role','tab');
    b.setAttribute('aria-label', `Go to slide ${i+1}`);
    b.addEventListener('click', () => goTo(i));
    dotsWrap.appendChild(b);
    return b;
  });

  let index = 0;

  function updateUI(i){
    index = Math.max(0, Math.min(i, slides.length - 1));
    dots.forEach((d, k) => d.setAttribute('aria-selected', String(k === index)));
    slides.forEach((s, k) => s.setAttribute('aria-label', `${k+1} of ${slides.length}${k===index?' (current)':''}`));
  }

  function slideWidth(){
    const slide = slides[0];
    const styles = getComputedStyle(track);
    const gap = parseFloat(styles.columnGap || styles.gap || 0);
    return slide.getBoundingClientRect().width + gap;
  }

  function goTo(i){
    updateUI(i);
    track.scrollTo({ left: slideWidth() * index, behavior: 'smooth' });
  }

  // Prev/Next move by exactly one slide (one use case at a time)
  prev && prev.addEventListener('click', () => goTo(index - 1));
  next && next.addEventListener('click', () => goTo(index + 1));

  // Keyboard support
  track.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowRight') { e.preventDefault(); goTo(index + 1); }
    if (e.key === 'ArrowLeft')  { e.preventDefault(); goTo(index - 1); }
  });

  // Sync index after native scroll
  let t;
  track.addEventListener('scroll', () => {
    window.clearTimeout(t);
    t = window.setTimeout(() => {
      const i = Math.round(track.scrollLeft / slideWidth());
      updateUI(i);
    }, 80);
  }, { passive: true });

  // On resize, keep alignment to current slide
  window.addEventListener('resize', () => {
    track.scrollTo({ left: slideWidth() * index, behavior: 'auto' });
  });

  // Init
  updateUI(0);
})();
</script>

</body>
</html>